# Caminho do dockerfile
# docker/dockerfiles/{image_folder}/Dockerfile

services:
  # discovery:
  #   image: yuri000/squad13:discovery
  #   # build:
  #   #   context: ..
  #   #   dockerfile: docker/dockerfiles/jdk21-distroless-gradle/Dockerfile
  #   #   args:
  #   #     SERVICE_NAME: discovery
  #   ports:
  #     - "12999:12999"
  #   environment:
  #     - SERVER_PORT=12999
  #     - EUREKA_HOSTNAME=discovery

  # gateway:
  #   image: yuri000/squad13:gateway
  #   # build:
  #   #   context: ..
  #   #   dockerfile: docker/dockerfiles/jdk21-distroless-gradle/Dockerfile
  #   #   args:
  #   #     SERVICE_NAME: gateway
  #   ports:
  #     - "13000:13000"
  #   environment:
  #     - SERVER_PORT=13000
  #     - EUREKA_HOST=http://discovery:12999/eureka/
  #   # - CORS_ALLOWED_ORIGINS=http://localhost:3000,http://127.0.0.1:5173 | NÃ£o testado
  #   depends_on:
  #     - discovery

  client:
    build:
      context: ..
      dockerfile: docker/dockerfiles/react_vite_client/Dockerfile
      args:
        CLIENT_PATH: /front/FrontEnd-JotaNunes
    ports:
      - "13999:80"
    volumes:
      - ./logs/nginx-logs:/var/log/nginx

  monolito_db:
    image: postgres:16
    container_name: monolito_db
    restart: always
    environment:
      POSTGRES_DB: monolito
      POSTGRES_USER: postgres
      POSTGRES_PASSWORD: postgres
      PGDATA: /var/lib/postgresql/data/pgdata
    ports:
      - "5432:5432"
    volumes:
      - pg_data:/var/lib/postgresql/data

  mongo_db:
    image: mongo:latest
    container_name: mongo_db
    restart: always
    ports:
      - "27017:27017"
    environment:
      MONGO_INITDB_ROOT_USERNAME: admin
      MONGO_INITDB_ROOT_PASSWORD: admin
      MONGO_INITDB_DATABASE: monolito
    volumes:
      - mongo_data:/data/db


  # rabbitmq:
  #   image: rabbitmq:latest
  #   ports:
  #     - "5672:5672"
  #     - "15672:15672"
  #   environment:
  #     RABBITMQ_DEFAULT_USER: admin
  #     RABBITMQ_DEFAULT_PASS: admin
  #   volumes:
  #     - rabbitmq_data:/var/lib/rabbitmq

volumes:
  pg_data:
  mongo_data:
  # rabbitmq_data: